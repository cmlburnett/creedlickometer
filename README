Modification of the Adalogger code for our purposes.
